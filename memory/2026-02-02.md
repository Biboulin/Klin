# 2026-02-02 â€” Jour 1 - 2

## Session 1: Naissance de Jarvis ðŸ¤–

PremiÃ¨re conversation avec Valentin. Setup initial :
- **Mon nom :** Jarvis
- **Ma mission :** Assistant personnel + technique + business
- **Son profil :** 27 ans, gÃ©rant EURL informatique, DevOps/Cloud/Dev
- **Son objectif :** Construire des SaaS/micro-SaaS pour gÃ©nÃ©rer du MRR

### Ã€ faire
- [x] Confirmer timezone â†’ Europe/Paris
- [x] Configurer Telegram âœ…
- [x] Discuter des premiers projets SaaS en tÃªte

### Projet SaaS #1 : Simulateur de charges
**Cible :** GÃ©rants EURL, micro-entreprises, avocats
**Concept :** Calculateur de charges en fonction de la rÃ©munÃ©ration souhaitÃ©e
**Ã‰tat :** POC rÃ©alisÃ© sur Base44
**Potentiel :** Niche B2B claire, douleur rÃ©elle
**ModÃ¨le Ã©co envisagÃ© :** Freemium ou Leadgen (pas pub)

### Setup rÃ©alisÃ©
- âœ… Telegram configurÃ©
- âœ… Templates PO/Scrum crÃ©Ã©s (`templates/`)
- âœ… TOOLS.md mis Ã  jour
- ðŸ”„ GitHub CLI â€” token en cours
- ðŸ”„ Vercel CLI â€” token en cours

### DÃ©cisions
- Valentin veut garder Claude (pas GPT)
- Je joue PO/Scrum master pour les projets SaaS
- Focus qualitÃ© sur les features

---

## Session 2: Klin MVP Dev Sprint (Multi-turn)

### Sprint Summary

**Primary Focus:** Klin MVP launch (mid-March 2026, ~18 days remaining)

**Major Milestone:** Completed Phase 1 (Auth) + **Firebase â†’ Supabase Migration**

### Completed Work
âœ… User discovery analysis (4x/week chores, 7 core tasks, gamification motivation)
âœ… Product spec (CHORE_SHARE_SPEC.md) â€” vision, personas, features, roadmap
âœ… Expo boilerplate + design system (colors, typography, responsive Button)
âœ… Auth flows (SignUp/SignIn/Onboarding with household create/join)
âœ… Mobile-first refactor (48px touch targets, 16px fonts, tight spacing)
âœ… **CRITICAL DECISION:** Firebase â†’ Supabase migration
  - Switched backend to Supabase (PostgreSQL + Auth)
  - Refactored AuthContext to use Supabase
  - Updated useHousehold hook for Supabase
  - Created complete SQL schema (11 tables)
  - Created SUPABASE_SETUP.md documentation
  - Git commits pushed to GitHub
âœ… GitHub git workflow configured (auto [Jarvis] prefix on commits)
âœ… Fixed UX issues (small inputs, unreadable text, excessive whitespace)

### Commits
- `61f4693` â€” Expo boilerplate + Firebase config + design system
- `2aabefc` â€” Complete auth flows + mobile optimizations
- `fea42d4` â€” Mobile-first refactor (all screens)
- `4ac7361` â€” Firebase â†’ Supabase migration (Auth + DB refactored)

### Critical Blocker (BLOCKING PHASE 2)
âš ï¸ **Supabase credentials not configured**
- Valentin needs to create Supabase account
- Copy `EXPO_PUBLIC_SUPABASE_URL` + `EXPO_PUBLIC_SUPABASE_ANON_KEY`
- Create `.env` file in `/klin/` with credentials
- Run SQL schema in Supabase SQL Editor
- Enable Email auth provider
- **AFTER THIS:** Can test auth signup & proceed to Phase 2

### Next Phase (Phase 2: Task Management)
4-5 days to implement:
- Task CRUD (create/edit/delete UI)
- Task list views (today, week, all)
- Daily/weekly recurrence logic
- Mark task done + optional photo
- Household context integration

### Technical Stack (FINAL)
- **Frontend:** Expo (React Native) + TypeScript
- **Backend:** Supabase (PostgreSQL + Auth)
- **DevOps:** VPS Hostinger with Docker
- **VCS:** GitHub (`Biboulin/Klin`) with git hook [Jarvis] prefix
- **Design:** Minimal (cream #F5F1EE, sage green #9A9973, pastels)

### Key Tech Decisions Made
1. Firebase â†’ Supabase (PostgreSQL > Firebase for scale, easier to manage)
2. Mobile-first design (48px buttons, 16px fonts, minimal whitespace)
3. Freemium model (â‚¬3.99/month for unlimited households + analytics)
4. 7 core task templates (cuisine, poubelles, aspirateur, vaisselle, lessive, ranger salon/chambre)
5. Gamification core to engagement (points +1/task, streaks, 8 badges, leaderboard)

### MVP Timeline
- **Start:** Early Feb 2026
- **Target:** Mid-March 2026 (~18 days)
- **Phases:** 1-Auth (done), 2-Tasks (4-5d), 3-Gamification (4-5d), 4-Notifications+Polish (2-3d)

### Debugging Discoveries (Feb 27)
**Problem Chain:**
1. **Household creation failing** â†’ Foreign key constraint `households_created_by_fkey`
   - Root cause: User existed in auth.users but NOT in public.users
   - Why? The trigger `on_auth_user_created` didn't fire when signup happened before trigger was created
   
2. **RLS Policy Recursion** â†’ "infinite recursion detected in policy for relation household_members"
   - Fixed by removing circular policy references
   - Solution: Use direct FK check instead of EXISTS on same table
   
3. **Missing INSERT Policies** â†’ Tables had SELECT but no INSERT/UPDATE policies
   - Added explicit policies: Users can INSERT their own profiles
   - Fixed by enabling proper RLS policies before testing

**Solutions Implemented:**
- Added fallback user profile creation in `useHousehold.createHousehold()` - checks if user exists in public.users, creates if missing
- Improved error logging throughout auth flow (AuthContext, SignUpScreen, useHousehold)
- All Supabase SQL properly configured with RLS + trigger
- Git commits pushing properly with auto-[Jarvis] prefix

### Lessons Learned
- Mobile UI design at launch is critical (fixed whitespace, button sizes early)
- Switching backends mid-project requires care (Supabase migration went smooth via refactored services layer)
- Clear commit messages + git hooks improve workflow discipline
- Product spec upfront saves rework downstream (clear personas + features from day 1)
- **RLS + Triggers require careful sequencing** - don't assume trigger fires before dependent code runs
- **Fallback mechanisms matter** - auth flow needs to handle race conditions gracefully
